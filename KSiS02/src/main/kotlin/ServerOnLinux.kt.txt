import java.io.*
import java.net.*

fun main() {
    val serverPort = 8080
    val serverSocket = ServerSocket(serverPort)
    println("Сервер запущен и ожидает подключений на порту $serverPort")

    while (true) {
        // Ожидание подключения клиента
        val clientSocket = serverSocket.accept()
        println("Подключение клиента: ${clientSocket.inetAddress.hostAddress}")

        // Получение данных
        val inputStream = clientSocket.getInputStream()
        val dataSize = 1024
        val data = ByteArray(dataSize)
        inputStream.read(data)

        // Сравнение данных с эталоном
        val expectedData = ByteArray(dataSize)
        val random = java.util.Random()
        random.nextBytes(expectedData)
        val result = if (data.contentEquals(expectedData)) 1 else 0

        // Отправка результата клиенту
        val outputStream = clientSocket.getOutputStream()
        outputStream.write(result)
        outputStream.flush()

        // Закрытие соединения с клиентом
        clientSocket.close()
    }
}